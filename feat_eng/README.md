## 📂 피처 엔지니어링 개요

### feat_eng 디렉토리 개요

- **FE_gw.ipynb**: 이 노트북은 기본 데이터 전처리와 POI(관심 지점) 데이터를 이용한 피처 엔지니어링을 다룹니다. 지하철역, 학교, 공원 등 주변 시설을 이용한 피처들이 포함되어 있습니다.
- **feat_eng.py**: 주요 피처 엔지니어링 스크립트입니다. `complex_id`와 같은 주요 피처를 생성하고, 근처 POI까지의 거리를 계산합니다.
- **feat_eng2.ipynb**: 클러스터링 기반 접근 방식을 이용해 피처 엔지니어링을 확장합니다. Prophet 모델을 사용하여 클러스터 기반의 추가 시계열 피처를 생성합니다.
- **utils.py**: 데이터 처리 중 메모리 사용량을 최적화하기 위한 유틸리티 함수들이 포함되어 있습니다.

### 📊 주요 피처 설명

#### 위치기반 변수

1. **`complex_id`**  
   - **설명**: 같은 아파트 단지를 구분하는 라벨.  
   - **방법**: 동일한 `latitude`, `longitude` 값을 가진 데이터들을 하나의 단지로 묶음.  
   - **기대효과**: 같은 단지의 경우 전세가가 비슷할 가능성이 높음.  

2. **`num_[ ]_within_[ ]`**  
   - **설명**: `complex_id`별 반경 `0.5, 1, 1.5, 2` km 이내에 위치한 `지하철`, `학교`, `공원`의 개수.  
   - **방법**: BallTree 알고리즘을 사용하여 근처 POI의 개수를 계산.  
   - **기대효과**: 주요 시설이 가까운 단지일수록 전세가 상승 가능성.  

3. **`nearest_[ ]_distance_km`**  
   - **설명**: 가장 가까운 `지하철`, `학교`, `공원`까지의 거리 (단위: km).  
   - **방법**: BallTree를 이용하여 계산.  
   - **기대효과**: 주요 시설과 가까울수록 전세가가 높아질 가능성.  

4. **`cluster_labels`**  
   - **설명**: 비슷한 단지를 클러스터로 묶은 라벨.  
   - **방법**: K-means로 `latitude`, `longitude`가 가까운 단지들을 클러스터링.  
   - **기대효과**: 데이터가 부족한 단지의 전세가를 클러스터 기반으로 보완 가능.  

5. **`nearest_transportation_hub`**  
   - **설명**: 각 아파트와 주요 교통 허브와의 거리.  
   - **방법**: 다중 환승역으로 간주되는 주요 지점과의 거리를 계산.  
   - **기대효과**: 서울 주요 거점과의 거리 반영을 통해 전세가 분석.  

#### 과거 전세가 관련 변수

1. **`previous_deposit`**  
   - **설명**: 단지 내 유사 면적의 최신 거래 전세가.  
   - **방법**: `complex_id`, `area_m2` 기준 최신 거래 전세가를 추출.  
   - **기대효과**: 예측 시 전세가의 기준점으로 활용.  

2. **`previous_deposit2`**  
   - **설명**: `previous_deposit`의 시점을 통일시킨 전세가.  
   - **방법**: 월별 전세가 변화 비율을 적용해 23년 12월 기준으로 보정.  
   - **기대효과**: 최신 시점으로 통일된 전세가 비교 가능.  

3. **`max_deposit`**  
   - **설명**: 과거 단지 내 유사 면적 거래 중 최대 전세가.  
   - **방법**: `complex_id`, `area_m2` 기준으로 그룹화하여 최대값 추출.  
   - **기대효과**: 전세가 최고치를 기준으로 상승세 분석.  

4. **`half_max_deposit`**  
   - **설명**: 반기별 최대 전세가.  
   - **방법**: 반기 기준 그룹화하여 각 반기별 최대값 계산.  
   - **기대효과**: 시간별 전세가 추세 반영.  

5. **`deposit_std_id`**  
   - **설명**: 같은 단지 내 유사 면적 전세가의 표준편차.  
   - **방법**: `complex_id`, `area_m2` 기준 표준편차 계산.  
   - **기대효과**: 동일 단지 내 변동성 파악.  

6. **`deposit_index_flag`**  
   - **설명**: 월별 전세가의 증감 여부를 나타내는 플래그 (증가: 1, 감소: 0).  
   - **방법**: 월별 전세가 차분값으로 선형 회귀 분석 후 추세 반영.  
   - **기대효과**: 전세가의 월별 추세를 반영하여 예측의 정밀도 향상.  

7. **`deposit_mean_last_year`, `deposit_std_last_year`**  
   - **설명**: 그룹별 과거 1년간 평균 전세가와 표준편차.  
   - **기대효과**: 과거 데이터를 반영한 현재 전세가 예측.  

#### 시간을 고려한 변수

1. **`monthly_new_supply`**  
   - **설명**: 전월 신축 거래량.  
   - **방법**: `contract_year_month`별로 age가 0인 거래의 개수.  
   - **기대효과**: 신축 거래량이 전세가에 미치는 영향 반영.  

2. **`contract_count_last_year`** 등  
   - **설명**: 이전 연도, 분기, 월, 반기의 계약 건수 집계.  
   - **기대효과**: 과거 계약량이 전세가에 미치는 영향을 반영.  

#### 상호작용 변수

1. **`area_floor_interaction`**  
   - **설명**: 면적과 층수 간의 상호작용항.  
   - **방법**: `area_m2`와 `floor`의 곱.  
   - **기대효과**: 면적과 층수의 상호작용을 모델에 반영.  

#### 이자율 관련 변수

1. **`previous_month_interest_rate`**  
   - **설명**: 이전 달 금리.  
   - **방법**: `contract_year_month`를 기준으로 금리 데이터를 시프트하여 추가.  
   - **기대효과**: 금리 변화가 전세가에 미치는 영향 반영.  

2. **`previous_month_interest_rate_diff`**  
   - **설명**: 이전 달 금리와의 차이.  
   - **방법**: 금리의 전월 대비 차이를 계산.  
   - **기대효과**: 금리 변동 폭이 전세가에 미치는 영향 파악.  

3. **`previous_{window}month_interest_rate_roll`**  
   - **설명**: 과거 월간 롤링 평균 금리.  
   - **기대효과**: 금리의 장기 추세 반영.  

4. **`3_month_slope`**  
   - **설명**: 최근 3개월 금리의 기울기.  
   - **방법**: 최근 3개월 데이터를 이용해 선형 회귀로 기울기 계산.  
   - **기대효과**: 금리 상승/하락 추세가 전세가에 미치는 영향을 분석.  

이 내용으로 README를 작성하면, 새로운 피처들이 어떻게 생성되고 사용되는지 잘 정리할 수 있을 거야. 혹시 더 추가하거나 변경하고 싶은 부분이 있으면 말해줘! 😊

